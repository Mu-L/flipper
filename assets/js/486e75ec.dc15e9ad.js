"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[5319],{3905:(e,t,n)=>{n.r(t),n.d(t,{MDXContext:()=>l,MDXProvider:()=>u,mdx:()=>v,useMDXComponents:()=>p,withMDXComponents:()=>d});var i=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(){return o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},o.apply(this,arguments)}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t){if(null==e)return{};var n,i,r=function(e,t){if(null==e)return{};var n,i,r={},o=Object.keys(e);for(i=0;i<o.length;i++)n=o[i],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=i.createContext({}),d=function(e){return function(t){var n=p(t.components);return i.createElement(e,o({},t,{components:n}))}},p=function(e){var t=i.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):a(a({},t),e)),n},u=function(e){var t=p(e.components);return i.createElement(l.Provider,{value:t},e.children)},f={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},m=i.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,s=e.parentName,l=c(e,["components","mdxType","originalType","parentName"]),d=p(n),u=r,m=d["".concat(s,".").concat(u)]||d[u]||f[u]||o;return n?i.createElement(m,a(a({ref:t},l),{},{components:n})):i.createElement(m,a({ref:t},l))}));function v(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,s=new Array(o);s[0]=m;var a={};for(var c in t)hasOwnProperty.call(t,c)&&(a[c]=t[c]);a.originalType=e,a.mdxType="string"==typeof e?e:r,s[1]=a;for(var l=2;l<o;l++)s[l]=n[l];return i.createElement.apply(null,s)}return i.createElement.apply(null,n)}m.displayName="MDXCreateElement"},13919:(e,t,n)=>{function i(e){return!0===/^(\w*:|\/\/)/.test(e)}function r(e){return void 0!==e&&!i(e)}n.d(t,{b:()=>i,Z:()=>r})},44996:(e,t,n)=>{n.r(t),n.d(t,{useBaseUrlUtils:()=>o,default:()=>s});var i=n(52263),r=n(13919);function o(){var e=(0,i.default)().siteConfig,t=(e=void 0===e?{}:e).baseUrl,n=void 0===t?"/":t,o=e.url;return{withBaseUrl:function(e,t){return function(e,t,n,i){var o=void 0===i?{}:i,s=o.forcePrependBaseUrl,a=void 0!==s&&s,c=o.absolute,l=void 0!==c&&c;if(!n)return n;if(n.startsWith("#"))return n;if((0,r.b)(n))return n;if(a)return t+n;var d=n.startsWith(t)?n:t+n.replace(/^\//,"");return l?e+d:d}(o,n,e,t)}}}function s(e,t){return void 0===t&&(t={}),(0,o().withBaseUrl)(e,t)}},13812:(e,t,n)=>{n.r(t),n.d(t,{frontMatter:()=>a,contentTitle:()=>c,metadata:()=>l,toc:()=>d,default:()=>u});var i=n(83117),r=n(80102),o=(n(67294),n(3905)),s=(n(44996),["components"]),a={id:"device-identifiers",title:"Device Identifiers",sidebar_label:"Device Identifiers"},c=void 0,l={unversionedId:"internals/device-identifiers",id:"internals/device-identifiers",isDocsHomePage:!1,title:"Device Identifiers",description:"Flipper is capable of discovering and listing available devices for multiple platforms.",source:"@site/../docs/internals/device-identifiers.mdx",sourceDirName:"internals",slug:"/internals/device-identifiers",permalink:"/docs/internals/device-identifiers",editUrl:"https://github.com/facebook/flipper/blob/main/website/../docs/internals/device-identifiers.mdx",tags:[],version:"current",frontMatter:{id:"device-identifiers",title:"Device Identifiers",sidebar_label:"Device Identifiers"},sidebar:"internals",previous:{title:"Linters",permalink:"/docs/internals/linters"}},d=[{value:"How does Flipper map connecting apps to their respective devices?",id:"how-does-flipper-map-connecting-apps-to-their-respective-devices",children:[],level:3}],p={toc:d};function u(e){var t=e.components,a=(0,r.Z)(e,s);return(0,o.mdx)("wrapper",(0,i.Z)({},p,a,{components:t,mdxType:"MDXLayout"}),(0,o.mdx)("p",null,"Flipper is capable of discovering and listing available devices for multiple platforms.\nOn itself, it allows users to check for connected devices and quickly use a number of plugins:"),(0,o.mdx)("ul",null,(0,o.mdx)("li",{parentName:"ul"},"Logs"),(0,o.mdx)("li",{parentName:"ul"},"Mobile Builds"),(0,o.mdx)("li",{parentName:"ul"},"Crash Reporter")),(0,o.mdx)("p",null,"Device information, including identifiers, are obtained using either ",(0,o.mdx)("inlineCode",{parentName:"p"},"idb list-targets --json")," on iOS or\n",(0,o.mdx)("inlineCode",{parentName:"p"},"adb devices")," on Android.  "),(0,o.mdx)("p",null,"On Flipper Desktop, apps are shown alongside the device it's running on."),(0,o.mdx)("p",null,"It seems a trivial problem to solve. Unfortunately, this is not the case.\nOn the client side, obtaining the device identifier is a problem."),(0,o.mdx)("h3",{id:"how-does-flipper-map-connecting-apps-to-their-respective-devices"},"How does Flipper map connecting apps to their respective devices?"),(0,o.mdx)("p",null,"Over the years, both Apple and Google have locked down their APIs so that apps can't find any value that\ncould be considered unique like a MAC address, serial numbers, etc., for privacy reasons. This means there's no OS API available.   "),(0,o.mdx)("p",null,"So, to obtain this device identifier, a two-way approached had to be used."),(0,o.mdx)("p",null,"From the Flipper Desktop side, connected devices are discovered and listed using idb or adb as mentioned above, and it sees some tcp connections coming in from apps.\nIt is during the certificate exchange process that we do the mapping from apps to device."),(0,o.mdx)("p",null,"In this process, an app creates and sends a CSR to Flipper Desktop alongside some other data\nincluding the path in the application sandbox where this CSR was originally written. "),(0,o.mdx)("p",null,"When Flipper Desktop is processing the request, it effectively lists all possible connected devices and proceeds\nto try and pull the CSR from each device. The CSR is then compared with the one sent by the client. If there's a match,\nwe have successfuly made the pairing and the device identifier is sent back to the client."),(0,o.mdx)("p",null,"The client receives the device identifier and uses this information for subsequent secure tcp connections."),(0,o.mdx)("p",null,"When a secure tcp connection is established, the device identifier is passed along and thus Flipper is able to map the connecting app to its running device."),(0,o.mdx)("p",null,"The diagram below depicts this process."),(0,o.mdx)("p",null,(0,o.mdx)("img",{alt:"Device Identifier Sequence",src:n(84065).Z})))}u.isMDXComponent=!0},84065:(e,t,n)=>{n.d(t,{Z:()=>i});const i=n.p+"assets/images/sequence_device_id-a35e8f147d8a1b127458815d08e41e3e.png"}}]);